<div class="border-end text-white p-3" id="sidebar-wrapper">
  <!-- Close button for mobile -->
  <div class="d-flex justify-content-between align-items-center mb-3 d-lg-none">
    <h5 class="mb-0">Filters</h5>
    <button type="button" class="btn btn-outline-light btn-sm" (click)="onCloseSidebar()" aria-label="Close sidebar">
      <i class="bi bi-x-lg"></i>
    </button>
  </div>
  
  <!-- Desktop title -->
  <h5 class="d-none d-lg-block mb-3">Filters</h5>

  <label>Skills</label>
  <div class="w-100 mb-2 position-relative">
    <button class="btn btn-light w-100" type="button" (click)="toggleSkillsDropdown()">
      {{ selectedSkills.length ? selectedSkills.length + ' selected' : 'Select skills' }}
    </button>
    <ul class="list-group position-absolute w-100" *ngIf="skillsOpen" style="z-index:1000; max-height: 240px; overflow:auto;">
      <li class="list-group-item d-flex justify-content-between align-items-center sticky-top bg-white">
        <span class="fw-semibold">Select skills</span>
        <button type="button" class="btn btn-sm btn-outline-secondary" (click)="skillsOpen=false" aria-label="Close">&times;</button>
      </li>
      <li *ngFor="let s of availableSkills; trackBy: trackBySkill" class="list-group-item">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" [id]="'skill_'+s" [checked]="selectedSkills.includes(s)" (change)="onSkillToggle(s, $event)">
          <label class="form-check-label" [for]="'skill_'+s">{{ s }}</label>
        </div>
      </li>
    </ul>
  </div>
  <div class="mb-2">
    <span *ngFor="let s of selectedSkills; trackBy: trackBySkill" class="badge bg-primary me-1">{{ s }}</span>
  </div>

  <label>Locations</label>
  <div class="w-100 mb-2 position-relative">
    <button class="btn btn-light w-100" type="button" (click)="toggleLocationsDropdown()">
      {{ selectedLocations.length ? selectedLocations.length + ' selected' : 'Select locations' }}
    </button>
    <ul class="list-group position-absolute w-100" *ngIf="locationsOpen" style="z-index:1000; max-height: 240px; overflow:auto;">
      <li class="list-group-item d-flex justify-content-between align-items-center sticky-top bg-white">
        <span class="fw-semibold">Select locations</span>
        <button type="button" class="btn btn-sm btn-outline-secondary" (click)="locationsOpen=false" aria-label="Close">&times;</button>
      </li>
      <li *ngFor="let l of availableLocations; trackBy: trackByLocation" class="list-group-item">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" [id]="'loc_'+l" [checked]="selectedLocations.includes(l)" (change)="onLocationToggle(l, $event)">
          <label class="form-check-label" [for]="'loc_'+l">{{ l }}</label>
        </div>
      </li>
    </ul>
  </div>
  <div class="mb-2">
    <span *ngFor="let l of selectedLocations; trackBy: trackByLocation" class="badge bg-success me-1">{{ l }}</span>
  </div>
  
  <label>Years of Experience: {{ formatYears(years) }}</label>
  <div class="range-slider-container mb-3">
    <input 
      type="range" 
      class="form-range" 
      [min]="yearsMin" 
      [max]="yearsMax" 
      [step]="yearsStep"
      [ngModel]="years || yearsMin" 
      (ngModelChange)="yearsChange.emit($event === yearsMin ? null : $event)"
      id="yearsRange">
    <div class="range-labels d-flex justify-content-between">
      <small class="text-muted">{{ yearsMin }}+ years</small>
      <small class="text-muted">{{ yearsMax }}+ years</small>
    </div>
  </div>

  <label>Min Salary: {{ formatSalary(minSalary) }}</label>
  <div class="range-slider-container mb-3">
    <input 
      type="range" 
      class="form-range" 
      [min]="minSalaryMin" 
      [max]="minSalaryMax" 
      [step]="minSalaryStep"
      [ngModel]="minSalary || minSalaryMin" 
      (ngModelChange)="minSalaryChange.emit($event === minSalaryMin ? null : $event)"
      id="minSalaryRange">
    <div class="range-labels d-flex justify-content-between">
      <small class="text-muted">{{ formatSalary(minSalaryMin) }}</small>
      <small class="text-muted">{{ formatSalary(minSalaryMax) }}</small>
    </div>
  </div>

  <label>Max Salary: {{ formatSalary(maxSalary) }}</label>
  <div class="range-slider-container mb-3">
    <input 
      type="range" 
      class="form-range" 
      [min]="maxSalaryMin" 
      [max]="maxSalaryMax" 
      [step]="maxSalaryStep"
      [ngModel]="maxSalary || maxSalaryMax" 
      (ngModelChange)="maxSalaryChange.emit($event === maxSalaryMax ? null : $event)"
      id="maxSalaryRange">
    <div class="range-labels d-flex justify-content-between">
      <small class="text-muted">{{ formatSalary(maxSalaryMin) }}</small>
      <small class="text-muted">{{ formatSalary(maxSalaryMax) }}</small>
    </div>
  </div>

  <button class="btn btn-secondary w-100 text-white" (click)="reset.emit()">
    <i class="bi bi-x-circle me-1"></i>Reset All
  </button>

</div>


